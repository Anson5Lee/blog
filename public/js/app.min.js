!function(){function e(e,l){e.when("/article",{templateUrl:"spa_client/views/home.view.client.html",controller:"homeCtrl"}).when("/article/:aid",{templateUrl:"spa_client/views/article.view.client.html",controller:"articleCtrl",resolve:{articleMeta:t}}).when("/register",{templateUrl:"spa_client/views/registration.view.client.html",controller:"registerCtrl"}).when("/login",{templateUrl:"spa_client/views/login.view.client.html",controller:"loginCtrl"}).otherwise({redirectTo:"/article"}),l.html5Mode(!0)}function t(e,t){var l=e.current.params.aid,r=t.getArticleById(l);return r}angular.module("AnsonBlog",["ngRoute","ui.bootstrap"]).config(e),e.$inject=["$routeProvider","$locationProvider"],t.$inject=["$route","ArticleService"]}();
!function(){function t(t,e,n,o,i,a,c,l,r){function s(){return{articleTitle:t.article.title,articleId:e.aid}}t.article=r.data.data,t.isCommentsShown=!1,t.showComments=function(){t.isCommentsShown=!0},t.isLoggedIn=o.isLoggedIn(),t.currentPath=i.path(),t.checkSafeHTML=function(t){return l.trustAsHtml(t)},t.popupCommentModal=function(){var e=a.open({templateUrl:"spa_client/views/comment.view.client.html",controller:"commentModalCtrl",resolve:{articleData:s}});e.result.then(function(e){t.article.comments.push(e.data)})}}angular.module("AnsonBlog").controller("articleCtrl",t),t.$inject=["$scope","$routeParams","ArticleService","AuthenticationService","$location","$uibModal","$q","$sce","articleMeta"]}();
!function(){function o(o,n,c,e){o.articleData=n,o.onSubmit=function(){return console.log(o.comment),o.Error="",o.comment?void o.addComment(n.articleId,o.comment):(o.Error="评论内容不能为空！",!1)},o.addComment=function(n,c){e.addCommentByArticleId(n,{commentBody:c.commentBody}).success(function(n){o.modal.close(n)})},o.modal={close:function(o){c.close(o)},cancel:function(){c.dismiss("cancel")}}}angular.module("AnsonBlog").controller("commentModalCtrl",o),o.$inject=["$scope","articleData","$uibModalInstance","ArticleService"]}();
!function(){function c(c,e,t){c.checkSafeHTML=function(c){return t.trustAsHtml(c)},e.getAllArticles().success(function(e){c.articles=e.data})}angular.module("AnsonBlog").controller("homeCtrl",c),c.$inject=["$scope","ArticleService","$sce"]}();
!function(){function n(n,e,t){n.credentials={},n.returnPage=t.search().page,n.onSubmit=function(){e.login(n.credentials).then(function(){t.search("page",null),t.path(n.returnPage)})}}angular.module("AnsonBlog").controller("loginCtrl",n),n.$inject=["$scope","AuthenticationService","$location"]}();
!function(){function e(e,n,t){e.pageHeader="注册新用户",e.returnPage=t.search().page||"/",e.credentials={},e.onSubmit=function(){n.register(e.credentials).then(function(){t.search("page",null),t.path(e.returnPage)})}}angular.module("AnsonBlog").controller("registerCtrl",e),e.$inject=["$scope","AuthenticationService","$location"]}();
!function(){function n(n,t,r){n.currentPath=t.path(),n.isLoggedIn=r.isLoggedIn(),n.currentUser=r.currentUser(),n.$watch(r.isLoggedIn,function(t){n.isLoggedIn=t,n.currentUser=r.currentUser()});var o=function(){return t.path()};n.$watch(o,function(r,o){n.currentPath=t.path()}),n.logout=function(){r.logout(),t.path("/article")}}angular.module("AnsonBlog").controller("navigationCtrl",n),n.$inject=["$scope","$location","AuthenticationService"]}();
!function(){function t(){return{restrict:"EA",templateUrl:"spa_client/directives/navigation.template.html",controller:"navigationCtrl"}}angular.module("AnsonBlog").directive("navigation",t)}();
!function(){function e(){return{restrict:"A",scope:{placeHolder:"=",imageSrc:"="},templateUrl:"spa_client/directives/progressiveImg-tpl.html",link:function(e,a,r){var n=a.children().children(".ProgressiveMedia"),i=n.children(".ProgressiveMedia-canvas")[0],t=angular.element(new Image);n.append(t),t.on("load",function(){var e=i.getContext("2d");e.drawImage(t[0],0,0,i.width,i.height),StackBlur.canvasRGBA(i,0,0,i.width,i.height,9)}),t.addClass("ProgressiveMedia-thumbnail"),t.attr("crossorigin","anonymous"),t.attr("src",e.placeHolder);var s=angular.element(new Image);n.append(s),s.on("load",function(){s.addClass("isLoaded"),angular.element(i).attr("display","none")}),s.addClass("ProgressiveMedia-image"),s.attr("src",e.imageSrc)}}}angular.module("AnsonBlog").directive("progressiveImg",e)}();
!function(){function n(){return function(n){var t=n.replace(/\n/g,"<br/>");return t}}function t(n){return function(t,r){var e=String(t).replace(/<[^>]+>/gm,"");e.length;return n.trustAsHtml(e.length>r?e.substr(0,r-1):e)}}angular.module("AnsonBlog").filter("addHtmlLineBreaks",n).filter("limitHtml",t),t.$inject=["$sce"]}();
!function(){function t(t,e){function n(){return t.get("/api/article")}function r(e){return t.get("/api/article/"+e)}function i(n,r){return t.post("/api/article/"+n+"/comment",r,{headers:{Authorization:"Bearer "+e.getToken()}})}return{getAllArticles:n,getArticleById:r,addCommentByArticleId:i}}angular.module("AnsonBlog").factory("ArticleService",t),t.$inject=["$http","AuthenticationService"]}();
!function(){function n(n,e){function o(e){n.localStorage["Blog-Token"]=e}function t(e){return n.localStorage["Blog-Token"]}function r(n){return e.post("/api/user/register",n).success(function(n){o(n.token)})}function i(n){return e.post("/api/user/login",n).success(function(n){o(n.token)})}function u(e){n.localStorage.removeItem("Blog-Token")}function a(){var e=t();if(e){var o=decodeURIComponent(n.atob(e.split(".")[1])),r=JSON.parse(o);return r.exp>Date.now()/1e3}return!1}function c(){if(a()){var e=t(),o=decodeURIComponent(n.atob(e.split(".")[1])),r=JSON.parse(o);return{email:r.email,name:r.name}}}return{saveToken:o,getToken:t,register:r,login:i,logout:u,isLoggedIn:a,currentUser:c}}angular.module("AnsonBlog").factory("AuthenticationService",n),n.$inject=["$window","$http"]}();
//# sourceMappingURL=maps/app.min.js.map

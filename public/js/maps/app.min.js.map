{"version":3,"sources":["app.js","controllers/article.controller.client.js","controllers/comment.controller.client.js","controllers/home.controller.client.js","controllers/login.controller.client.js","controllers/registration.controller.client.js","filters/addHtmlLineBreaks.js","services/article.service.client.js","services/authentication.service.client.js","directives/navigation.controller.js","directives/navigation.directive.js","directives/progressiveImg.js"],"names":["configFn","$routeProvider","$locationProvider","when","templateUrl","controller","resolve","articleMeta","getArticleData","otherwise","redirectTo","html5Mode","$route","ArticleService","articleId","current","params","aid","promise","getArticleById","angular","module","config","$inject","articleController","$scope","$routeParams","AuthenticationService","$location","$uibModal","$q","$sce","articleData","articleTitle","article","title","data","isCommentsShown","showComments","isLoggedIn","currentPath","path","checkSafeHTML","html","trustAsHtml","popupCommentModal","uibModalInstance","open","result","then","comments","push","commentModalController","$uibModalInstance","onSubmit","Error","comment","commentBody","addComment","addCommentByArticleId","success","modal","close","cancel","dismiss","homeController","getAllArticles","response","console","log","articles","loginController","credentials","returnPage","search","page","login","registrationController","pageHeader","register","addHtmlLineBreaks","text","output","replace","limitHtml","limit","changedString","String","length","substr","filter","$http","get","id","post","headers","Authorization","getToken","factory","authentication","$window","saveToken","token","localStorage","user","logout","removeItem","payload","JSON","parse","atob","split","exp","Date","now","currentUser","email","name","navigationController","$watch","newVal","locationChangeFn","oldVal","navigation","restrict","directive","progressiveImg","scope","placeHolder","imageSrc","link","iScope","iElement","iAttrs","component","children","canvas","thumbnail","element","Image","append","on","context","getContext","drawImage","width","height","StackBlur","canvasRGBA","addClass","attr","image"],"mappings":"CAAA,WAME,QAASA,GAASC,EAAgBC,GACjCD,EACEE,KAAK,YACLC,YAAa,yCACbC,WAAY,aAEZF,KAAK,iBACLC,YAAa,4CACbC,WAAY,cACZC,SACCC,YAAcC,KAGfL,KAAK,aACLC,YAAa,iDACbC,WAAY,iBAEZF,KAAK,UACLC,YAAa,0CACbC,WAAY,cAEZI,WACAC,WAAY,aAEdR,EAAkBS,WAAU,GAK7B,QAASH,GAAeI,EAAQC,GAC/B,GAAIC,GAAYF,EAAOG,QAAQC,OAAOC,IAClCC,EAAWL,EAAeM,eAAeL,EAC7C,OAAOI,GArCTE,QACEC,OAAO,aAAc,UAAW,iBAChCC,OAAOtB,GAERA,EAASuB,SAAW,iBAAkB,qBA6BtCf,EAAee,SAAW,SAAU;CClCtC,WAKE,QAASC,GAAkBC,EAAQC,EAAcb,EAAgBc,EAAuBC,EAAWC,EAAWC,EAAIC,EAAMxB,GA4BvH,QAASyB,KACR,OACCC,aAAeR,EAAOS,QAAQC,MAC9BrB,UAAWY,EAAaT,KA9B1BQ,EAAOS,QAAU3B,EAAY6B,KAAKA,KAClCX,EAAOY,iBAAkB,EACzBZ,EAAOa,aAAe,WACrBb,EAAOY,iBAAkB,GAE1BZ,EAAOc,WAAaZ,EAAsBY,aAC1Cd,EAAOe,YAAcZ,EAAUa,OAC/BhB,EAAOiB,cAAgB,SAASC,GAC/B,MAAOZ,GAAKa,YAAYD,IAGzBlB,EAAOoB,kBAAoB,WAC1B,GAAIC,GAAmBjB,EAAUkB,MAChC3C,YAAa,4CACbC,WAAY,mBACZC,SACC0B,YAAaA,IAIfc,GACEE,OACAC,KAAK,SAASb,GACdX,EAAOS,QAAQgB,SAASC,KAAKf,EAAKA,SA5BvChB,QACEC,OAAO,aACPhB,WAAW,cAAemB,GAC3BA,EAAkBD,SAAW,SAAU,eAAgB,iBAAkB,wBAAyB,YAAa,YAAa,KAAM,OAAQ;CCJ5I,WAME,QAAS6B,GAAuB3B,EAAQO,EAAaqB,EAAmBxC,GACvEY,EAAOO,YAAcA,EACrBP,EAAO6B,SAAW,WAEjB,MADA7B,GAAO8B,MAAQ,GACV9B,EAAO+B,QAAQC,gBAInBhC,GAAOiC,WAAW1B,EAAYlB,UAAWW,EAAO+B,UAHhD/B,EAAO8B,MAAQ,aACR,IAMT9B,EAAOiC,WAAa,SAAS5C,EAAW0C,GACvC3C,EACE8C,sBAAsB7C,GACtB2C,YAAaD,EAAQC,cAErBG,QAAQ,SAASxB,GACjBX,EAAOoC,MAAMC,MAAM1B,MAKtBX,EAAOoC,OACNC,MAAQ,SAASd,GAChBK,EAAkBS,MAAMd,IAEzBe,OAAQ,WACPV,EAAkBW,QAAQ,YAjC9B5C,QACEC,OAAO,aACPhB,WAAW,mBAAoB+C,GAEhCA,EAAuB7B,SAAW,SAAU,cAAe,oBAAqB;CCLlF,WAME,QAAS0C,GAAexC,EAAQZ,EAAgBkB,GAC/CN,EAAOiB,cAAgB,SAASC,GAC/B,MAAOZ,GAAKa,YAAYD,IAEzB9B,EAAeqD,iBACbN,QAAQ,SAASO,GACjBC,QAAQC,IAAIF,EAAS/B,MACrBX,EAAO6C,SAAWH,EAAS/B,OAZ/BhB,QACEC,OAAO,aACPhB,WAAW,WAAY4D,GAExBA,EAAe1C,SAAW,SAAU,iBAAkB;CCLxD,WAMI,QAASgD,GAAgB9C,EAAQE,EAAuBC,GACtDH,EAAO+C,eACP/C,EAAOgD,WAAa7C,EAAU8C,SAASC,KACvClD,EAAO6B,SAAW,WAChB3B,EAAsBiD,MAAMnD,EAAO+C,aAChCvB,KAAK,WACJrB,EAAU8C,OAAO,OAAQ,MACzB9C,EAAUa,KAAKhB,EAAOgD,eAZhCrD,QACGC,OAAO,aACPhB,WAAW,YAAakE,GAEzBA,EAAgBhD,SAAW,SAAU,wBAAyB;CCLlE,WAMI,QAASsD,GAAuBpD,EAAQE,EAAuBC,GAC7DH,EAAOqD,WAAa,QACpBV,QAAQC,IAAIzC,EAAU8C,UACtBjD,EAAOgD,WAAa7C,EAAU8C,SAASC,MAAQ,IAC/ClD,EAAO+C,eACP/C,EAAO6B,SAAW,WAChB3B,EAAsBoD,SAAStD,EAAO+C,aACnCvB,KAAK,WACJrB,EAAU8C,OAAO,OAAQ,MACzB9C,EAAUa,KAAKhB,EAAOgD,eAdhCrD,QACGC,OAAO,aACPhB,WAAW,eAAgBwE,GAE5BA,EAAuBtD,SAAW,SAAU,wBAAyB;CCLzE,WAME,QAASyD,KACR,MAAO,UAAUC,GACf,GAAIC,GAASD,EAAKE,QAAQ,MAAO,QACjC,OAAOD,IAKV,QAASE,GAAUrD,GAClB,MAAO,UAASkD,EAAMI,GAErB,GAAIC,GAAgBC,OAAON,GAAME,QAAQ,YAAa,GAErCG,GAAcE,MAC3B,OAAOzD,GAAKa,YAAY0C,EAAcE,OAASH,EAAQC,EAAcG,OAAO,EAAGJ,EAAQ,GAAKC,IAnBlGlE,QACIC,OAAO,aACPqE,OAAO,oBAAqBV,GAC9BU,OAAO,YAAaN,GAStBA,EAAU7D,SAAW;CCbvB,WAME,QAASV,GAAe8E,EAAOhE,GAQ9B,QAASuC,KACR,MAAOyB,GAAMC,IAAI,gBAGlB,QAASzE,GAAe0E,GACvB,MAAOF,GAAMC,IAAI,gBAAkBC,GAGpC,QAASlC,GAAsBkC,EAAIzD,GAClC,MAAOuD,GAAMG,KAAK,gBAAkBD,EAAK,WAAYzD,GACpD2D,SACCC,cAAe,UAAWrE,EAAsBsE,cAjBnD,OACC/B,eAAgBA,EAChB/C,eAAgBA,EAChBwC,sBAAuBA,GAV1BvC,QACEC,OAAO,aACP6E,QAAQ,iBAAkBrF,GAE3BA,EAAeU,SAAW,QAAS;CCLrC,WAME,QAAS4E,GAAeC,EAAST,GAWhC,QAASU,GAAUC,GAClBF,EAAQG,aAAa,cAAgBD,EAGtC,QAASL,GAASK,GACjB,MAAOF,GAAQG,aAAa,cAG7B,QAASxB,GAASyB,GACjB,MAAOb,GAAMG,KAAK,qBAAsBU,GAAM5C,QAAQ,SAASxB,GAC9DiE,EAAUjE,EAAKkE,SAIjB,QAAS1B,GAAM4B,GACd,MAAOb,GAAMG,KAAK,kBAAmBU,GAAM5C,QAAQ,SAASxB,GAC3DiE,EAAUjE,EAAKkE,SAIjB,QAASG,GAAOD,GACfJ,EAAQG,aAAaG,WAAW,cAGjC,QAASnE,KACR,GAAI+D,GAAQL,GACZ,IAAIK,EAAO,CACV,GAAIK,GAAUC,KAAKC,MAAMT,EAAQU,KAAKR,EAAMS,MAAM,KAAK,IACvD,OAAOJ,GAAQK,IAAMC,KAAKC,MAAQ,IAElC,OAAO,EAIT,QAASC,KACR,GAAI5E,IAAc,CACjB,GAAI+D,GAAQL,IACRU,EAAUC,KAAKC,MAAMT,EAAQU,KAAKR,EAAMS,MAAM,KAAK,IACvD,QACCK,MAAOT,EAAQS,MACfC,KAAMV,EAAQU,OAlDjB,OACChB,UAAWA,EACXJ,SAAUA,EACVlB,SAAUA,EACVH,MAAOA,EACP6B,OAAQA,EACRlE,WAAYA,EACZ4E,YAAaA,GAbhB/F,QACEC,OAAO,aACP6E,QAAQ,wBAAyBC,GAElCA,EAAe5E,SAAW,UAAW;CCLvC,WAOI,QAAS+F,GAAqB7F,EAAQG,EAAWD,GAE/CF,EAAOe,YAAcZ,EAAUa,OAC/BhB,EAAOc,WAAaZ,EAAsBY,aAC1Cd,EAAO0F,YAAcxF,EAAsBwF,cAE3C1F,EAAO8F,OAAO5F,EAAsBY,WAAY,SAASiF,GACvD/F,EAAOc,WAAaiF,EACpB/F,EAAO0F,YAAcxF,EAAsBwF,eAE7C,IAAIM,GAAmB,WACrB,MAAO7F,GAAUa,OAEnBhB,GAAO8F,OAAOE,EAAkB,SAASD,EAAQE,GAC/CjG,EAAOe,YAAcZ,EAAUa,SAGjChB,EAAOgF,OAAS,WACd9E,EAAsB8E,SACpB7E,EAAUa,KAAK,aAzBvBrB,QACGC,OAAO,aACPhB,WAAW,iBAAkBiH,GAE9BA,EAAqB/F,SAAW,SAAU,YAAa;CCL3D,WA+BE,QAASoG,KACR,OACCC,SAAU,KACVxH,YAAa,iDACbC,WAAY,kBAlCfe,QACEC,OAAO,aACPwG,UAAU,aAAcF;CCH3B,WAKI,QAASG,KACP,OACEF,SAAU,IACVG,OACEC,YAAa,IACbC,SAAU,KAEZ7H,YAAa,gDAGb8H,KAAM,SAASC,EAAQC,EAAUC,GAI7B,GAAIC,GAAYF,EAASG,WAAWA,SAAS,qBACzCC,EAASF,EAAUC,SAAS,4BAA4B,GACxDE,EAAYrH,QAAQsH,QAAQ,GAAIC,OACpCL,GAAUM,OAAOH,GACjBA,EAAUI,GAAG,OAAQ,WACnB,GAAIC,GAAUN,EAAOO,WAAW,KAChCD,GAAQE,UAAUP,EAAU,GAAI,EAAG,EAAGD,EAAOS,MAAOT,EAAOU,QAC3DC,UAAUC,WAAWZ,EAAQ,EAAG,EAAGA,EAAOS,MAAOT,EAAOU,OAAQ,KAElET,EAAUY,SAAS,8BACnBZ,EAAUa,KAAK,cAAe,aAC9Bb,EAAUa,KAAK,MAAOnB,EAAOH,YAE7B,IAAIuB,GAAQnI,QAAQsH,QAAQ,GAAIC,OAChCL,GAAUM,OAAOW,GACjBA,EAAMV,GAAG,OAAQ,WACfU,EAAMF,SAAS,YACfjI,QAAQsH,QAAQF,GAAQc,KAAK,UAAW,UAE1CC,EAAMF,SAAS,0BACfE,EAAMD,KAAK,MAAOnB,EAAOF,YAtCnC7G,QACGC,OAAO,aACPwG,UAAU,iBAAkBC","file":"../app.min.js","sourcesContent":["(function(){\n\tangular\n\t\t.module('AnsonBlog', ['ngRoute', 'ui.bootstrap'])\n\t\t.config(configFn)\n\n\t\tconfigFn.$inject = ['$routeProvider', '$locationProvider'];\n\t\tfunction configFn($routeProvider, $locationProvider) {\n\t\t\t$routeProvider\n\t\t\t\t.when('/article', {\n\t\t\t\t\ttemplateUrl: 'spa_client/views/home.view.client.html',\n\t\t\t\t\tcontroller: 'homeCtrl'\n\t\t\t\t})\n\t\t\t\t.when('/article/:aid', {\n\t\t\t\t\ttemplateUrl: 'spa_client/views/article.view.client.html',\n\t\t\t\t\tcontroller: 'articleCtrl',\n\t\t\t\t\tresolve : {\n\t\t\t\t\t\tarticleMeta : getArticleData\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.when('/register', {\n\t\t\t\t\ttemplateUrl: 'spa_client/views/registration.view.client.html',\n\t\t\t\t\tcontroller: 'registerCtrl'\n\t\t\t\t})\n\t\t\t\t.when('/login', {\n\t\t\t\t\ttemplateUrl: 'spa_client/views/login.view.client.html',\n\t\t\t\t\tcontroller: 'loginCtrl'\n\t\t\t\t})\n\t\t\t\t.otherwise({\n\t\t\t\t\tredirectTo: '/article'\n\t\t\t\t})\n\t\t\t$locationProvider.html5Mode(true);\n\n\t\t}\n\n\t\tgetArticleData.$inject = ['$route', 'ArticleService'];\n\t\tfunction getArticleData($route, ArticleService) {\n\t\t\tvar articleId = $route.current.params.aid;\n\t\t\tvar promise =  ArticleService.getArticleById(articleId);\n\t\t\treturn promise;\n\t\t}\n\n})()\n","(function() {\n\tangular\n\t\t.module('AnsonBlog')\n\t\t.controller('articleCtrl', articleController)\n\t\tarticleController.$inject = ['$scope', '$routeParams', 'ArticleService', 'AuthenticationService', '$location', '$uibModal', '$q', '$sce', 'articleMeta']\n\t\tfunction articleController($scope, $routeParams, ArticleService, AuthenticationService, $location, $uibModal, $q, $sce, articleMeta) {\n\t\t\t$scope.article = articleMeta.data.data;\n\t\t\t$scope.isCommentsShown = false;\n\t\t\t$scope.showComments = function() {\n\t\t\t\t$scope.isCommentsShown = true;\n\t\t\t}\n\t\t\t$scope.isLoggedIn = AuthenticationService.isLoggedIn();\n\t\t\t$scope.currentPath = $location.path();\n\t\t\t$scope.checkSafeHTML = function(html) {\n\t\t\t\treturn $sce.trustAsHtml(html)\n\t\t\t}\n\n\t\t\t$scope.popupCommentModal = function() {\n\t\t\t\tvar uibModalInstance = $uibModal.open({\n\t\t\t\t\ttemplateUrl: 'spa_client/views/comment.view.client.html',\n\t\t\t\t\tcontroller: 'commentModalCtrl',\n\t\t\t\t\tresolve: {\n\t\t\t\t\t\tarticleData: articleData\n\t\t\t\t\t}\n\t\t\t\t})\n\n\t\t\t\tuibModalInstance\n\t\t\t\t\t.result\n\t\t\t\t\t.then(function(data) {\n\t\t\t\t\t\t$scope.article.comments.push(data.data);\n\t\t\t\t\t})\n\t\t\t}\n\n\t\t\tfunction articleData() {\n\t\t\t\treturn {\n\t\t\t\t\tarticleTitle : $scope.article.title,\n\t\t\t\t\tarticleId: $routeParams.aid\n\t\t\t\t}\n\t\t\t}\n\t\t}\n})()\n","(function() {\n\tangular\n\t\t.module('AnsonBlog')\n\t\t.controller('commentModalCtrl', commentModalController)\n\n\t\tcommentModalController.$inject = ['$scope', 'articleData', '$uibModalInstance', 'ArticleService'];\n\t\tfunction commentModalController($scope, articleData, $uibModalInstance, ArticleService) {\n\t\t\t$scope.articleData = articleData;\n\t\t\t$scope.onSubmit = function(){\n\t\t\t\t$scope.Error = \"\";\n\t\t\t\tif (!$scope.comment.commentBody) {\n\t\t\t\t\t$scope.Error = \"评论内容不能为空！\";\n\t\t\t\t\treturn false;\n\t\t\t\t} else {\n\t\t\t\t\t$scope.addComment(articleData.articleId, $scope.comment)\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t$scope.addComment = function(articleId, comment) {\n\t\t\t\tArticleService\n\t\t\t\t\t.addCommentByArticleId(articleId, {\n\t\t\t\t\t\tcommentBody: comment.commentBody\n\t\t\t\t\t})\n\t\t\t\t\t.success(function(data) {\n\t\t\t\t\t\t$scope.modal.close(data);\n\t\t\t\t\t})\n\n\t\t\t}\n\n\t\t\t$scope.modal = {\n\t\t\t\tclose : function(result) {\n\t\t\t\t\t$uibModalInstance.close(result);\n\t\t\t\t},\n\t\t\t\tcancel: function() {\n\t\t\t\t\t$uibModalInstance.dismiss('cancel');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n})()\n","(function() {\n\tangular\n\t\t.module('AnsonBlog')\n\t\t.controller('homeCtrl', homeController)\n\t\t\n\t\thomeController.$inject = ['$scope', 'ArticleService', '$sce'];\n\t\tfunction homeController($scope, ArticleService, $sce) {\n\t\t\t$scope.checkSafeHTML = function(html) {\n\t\t\t\treturn $sce.trustAsHtml(html)\n\t\t\t}\n\t\t\tArticleService.getAllArticles()\n\t\t\t\t.success(function(response) {\n\t\t\t\t\tconsole.log(response.data);\n\t\t\t\t\t$scope.articles = response.data;\n\t\t\t\t})\n\t\t}\n})()\n","(function() {\n  angular\n    .module('AnsonBlog')\n    .controller('loginCtrl', loginController)\n\n    loginController.$inject = ['$scope', 'AuthenticationService', '$location'];\n    function loginController($scope, AuthenticationService, $location) {\n      $scope.credentials = {};\n      $scope.returnPage = $location.search().page\n      $scope.onSubmit = function() {\n        AuthenticationService.login($scope.credentials)\n          .then(function() {\n            $location.search('page', null);\n            $location.path($scope.returnPage);\n          })\n      }\n    }\n})()\n","(function() {\n  angular\n    .module('AnsonBlog')\n    .controller('registerCtrl', registrationController)\n\n    registrationController.$inject = ['$scope', 'AuthenticationService', '$location'];\n    function registrationController($scope, AuthenticationService, $location) {\n      $scope.pageHeader = \"注册新用户\"\n      console.log($location.search());\n      $scope.returnPage = $location.search().page || '/';\n      $scope.credentials = {};\n      $scope.onSubmit = function() {\n        AuthenticationService.register($scope.credentials)\n          .then(function() {\n            $location.search('page', null);\n            $location.path($scope.returnPage);\n          })\n      }\n    }\n})()\n","(function() {\n\t angular\n    \t.module('AnsonBlog')\n    \t.filter('addHtmlLineBreaks', addHtmlLineBreaks)\n\t\t\t.filter('limitHtml', limitHtml)\n\n\t\tfunction addHtmlLineBreaks () {\n\t\t\treturn function (text) {\n\t\t\t  var output = text.replace(/\\n/g, '<br/>');\n\t\t\t  return output;\n\t\t\t};\n\t\t}\n\t\t\n\t\tlimitHtml.$inject = ['$sce'];\n\t\tfunction limitHtml($sce) {\n\t\t\treturn function(text, limit) {\n\t\t\t\t// console.log('HTML: ', text);\n\t\t\t\tvar changedString = String(text).replace(/<[^>]+>/gm, '');\n\t\t\t\t// console.log('text: ', changedString);\n        var length = changedString.length;\n        return $sce.trustAsHtml(changedString.length > limit ? changedString.substr(0, limit - 1) : changedString);\n    \t}\n\t\t}\n\n})()\n","(function() {\n\tangular\n\t\t.module('AnsonBlog')\n\t\t.factory('ArticleService', ArticleService)\n\n\t\tArticleService.$inject = ['$http', 'AuthenticationService'];\n\t\tfunction ArticleService($http, AuthenticationService) {\n\n\t\t\treturn {\n\t\t\t\tgetAllArticles: getAllArticles,\n\t\t\t\tgetArticleById: getArticleById,\n\t\t\t\taddCommentByArticleId: addCommentByArticleId\n\t\t\t}\n\n\t\t\tfunction getAllArticles() {\n\t\t\t\treturn $http.get('/api/article');\n\t\t\t}\n\n\t\t\tfunction getArticleById(id) {\n\t\t\t\treturn $http.get('/api/article/' + id);\n\t\t\t}\n\n\t\t\tfunction addCommentByArticleId(id, data) {\n\t\t\t\treturn $http.post('/api/article/' + id + '/comment', data, {\n\t\t\t\t\theaders: {\n\t\t\t\t\t\tAuthorization: 'Bearer '+ AuthenticationService.getToken()\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t}\n})()\n","(function() {\n\tangular\n\t\t.module('AnsonBlog')\n\t\t.factory('AuthenticationService', authentication)\n\n\t\tauthentication.$inject = ['$window', '$http'];\n\t\tfunction authentication($window, $http) {\n\t\t\treturn {\n\t\t\t\tsaveToken: saveToken,\n\t\t\t\tgetToken: getToken,\n\t\t\t\tregister: register,\n\t\t\t\tlogin: login,\n\t\t\t\tlogout: logout,\n\t\t\t\tisLoggedIn: isLoggedIn,\n\t\t\t\tcurrentUser: currentUser\n\t\t\t}\n\n\t\t\tfunction saveToken(token) {\n\t\t\t\t$window.localStorage['Blog-Token'] = token;\n\t\t\t}\n\n\t\t\tfunction getToken(token) {\n\t\t\t\treturn $window.localStorage['Blog-Token'];\n\t\t\t}\n\n\t\t\tfunction register(user) {\n\t\t\t\treturn $http.post('/api/user/register', user).success(function(data) {\n\t\t\t\t\tsaveToken(data.token);\n\t\t\t\t})\n\t\t\t}\n\n\t\t\tfunction login(user) {\n\t\t\t\treturn $http.post('/api/user/login', user).success(function(data) {\n\t\t\t\t\tsaveToken(data.token);\n\t\t\t\t})\n\t\t\t}\n\n\t\t\tfunction logout(user) {\n\t\t\t\t$window.localStorage.removeItem('Blog-Token');\n\t\t\t}\n\n\t\t\tfunction isLoggedIn() {\n\t\t\t\tvar token = getToken();\n\t\t\t\tif (token) {\n\t\t\t\t\tvar payload = JSON.parse($window.atob(token.split('.')[1]));\n\t\t\t\t\treturn payload.exp > Date.now() / 1000;\n\t\t\t\t} else {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction currentUser() {\n\t\t\t\tif (isLoggedIn()) {\n\t\t\t\t\tvar token = getToken();\n\t\t\t\t\tvar payload = JSON.parse($window.atob(token.split('.')[1]));\n\t\t\t\t\treturn {\n\t\t\t\t\t\temail: payload.email,\n\t\t\t\t\t\tname: payload.name\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n})()\n","(function(){\n  angular\n    .module('AnsonBlog')\n    .controller('navigationCtrl', navigationController)\n\n    navigationController.$inject = ['$scope', '$location', 'AuthenticationService'];\n\n    function navigationController($scope, $location, AuthenticationService) {\n\n      $scope.currentPath = $location.path();\n      $scope.isLoggedIn = AuthenticationService.isLoggedIn();\n      $scope.currentUser = AuthenticationService.currentUser();\n      // $scope.isAdmin = $scope.currentUser.email === 'frank5li@163.com' ? true : false;\n      $scope.$watch(AuthenticationService.isLoggedIn, function(newVal){\n        $scope.isLoggedIn = newVal;\n        $scope.currentUser = AuthenticationService.currentUser();\n      })\n      var locationChangeFn = function() {\n        return $location.path();\n      }\n      $scope.$watch(locationChangeFn, function(newVal, oldVal) {\n        $scope.currentPath = $location.path();\n      })\n\n      $scope.logout = function() {\n        AuthenticationService.logout();\n          $location.path('/article');\n      }\n    }\n})()\n","(function() {\n\tangular\n\t\t.module('AnsonBlog')\n\t\t.directive('navigation', navigation)\n\t\t// .directive(\"ngRem\", ['$document', function($document) {\n\t\t// \treturn function(scope, element, attrs) {\n\t\t// \t\t// var ratio = 24/1280,\n\t\t// \t\tvar ratio = 24/1920,\n\t\t// \t\t\tW = window.innerWidth,\n\t\t// \t\t\tHTML = $document[0].querySelector(\"html\");\n\t\t// \t\tHTML.style.fontSize = ratio*W + 'px';\n\t\t// \t}\n\t\t// }])\n\t\t// .directive(\"changeBg\", ['$window', function($window) {\n\t\t// \tvar bannerHeight = 0;\n\t\t// \t$window.addEventListener(\"load\", changeBgInit, false);\n\t\t// \tfunction changeBgInit() {\n\t\t// \t\tvar banner = document.querySelector('.banner');\n\t\t// \t\tbannerHeight = banner.clientHeight;\n\t\t// \t}\n\t\t// \treturn function(scope, element, attrs) {\n\t\t// \t\t$window.addEventListener(\"scroll\", function() {\n\t\t// \t\t\tif($window.scrollY > bannerHeight) {\n\t\t// \t\t\t\telement.css(\"background-color\", \"#FFF\");\n\t\t// \t\t\t} else {\n\t\t// \t\t\t\telement.css(\"background-color\", \"transparent\");\n\t\t// \t\t\t}\n\t\t// \t\t}, false)\n\t\t// \t}\n\t\t// }])\n\n\t\tfunction navigation() {\n\t\t\treturn {\n\t\t\t\trestrict: 'EA',\n\t\t\t\ttemplateUrl: 'spa_client/directives/navigation.template.html',\n\t\t\t\tcontroller: 'navigationCtrl'\n\t\t\t}\n\t\t}\n})()\n","(function(){\n  angular\n    .module('AnsonBlog')\n    .directive('progressiveImg', progressiveImg)\n\n    function progressiveImg() {\n      return {\n        restrict: \"A\",\n        scope: {\n          placeHolder: \"=\",\n          imageSrc: \"=\"\n        },\n        templateUrl: 'spa_client/directives/progressiveImg-tpl.html',\n        // compile: function(tElement, tAttributes) {\n\n        link: function(iScope, iElement, iAttrs) {\n            // console.log(iScope);\n            // console.log(iScope.placeHolder);\n            // console.log(iScope.imageSrc);\n            var component = iElement.children().children('.ProgressiveMedia');\n            var canvas = component.children('.ProgressiveMedia-canvas')[0];\n            var thumbnail = angular.element(new Image());\n            component.append(thumbnail);\n            thumbnail.on('load', function() {\n              var context = canvas.getContext(\"2d\");\n              context.drawImage(thumbnail[0], 0, 0, canvas.width, canvas.height);\n              StackBlur.canvasRGBA(canvas, 0, 0, canvas.width, canvas.height, 9);\n            });\n            thumbnail.addClass('ProgressiveMedia-thumbnail');\n            thumbnail.attr('crossorigin', 'anonymous');\n            thumbnail.attr('src', iScope.placeHolder);\n\n            var image = angular.element(new Image());\n            component.append(image);\n            image.on('load', function() {\n              image.addClass('isLoaded');\n              angular.element(canvas).attr('display', 'none');\n            })\n            image.addClass('ProgressiveMedia-image');\n            image.attr('src', iScope.imageSrc);\n          }\n        // }\n      }\n    }\n})()\n"]}